/dts-v1/;

#include <dt-bindings/interrupt-controller/arm-gic.h>
#include <dt-bindings/interrupt-controller/irq.h>
#include <dt-bindings/muen/channel-muensk.h>

/ {
    model = "Xilinx UltraScale+ ZCU104 - Muen ARM64";
    compatible = "xlnx,zynqmp-zcu104-revA", "xlnx,zynqmp-zcu104", "xlnx,zynqmp";
    interrupt-parent = <0x7>;

    #address-cells = <0x2>;
    #size-cells = <0x2>;

    aliases {
        serial = &serial_0;
    };

    chosen {
        bootargs = "hostname=lnx1 console=ttyPS0,115200 root=/dev/ram0 initrd=0x2b000000,60M earlycon muen_sinfo=0xe00000000 muennet.name=net0 muennet.reader_protocol=2 muennet.writer_protocol=2 muennet.in=net_in muennet.out=net_out muennet.flags=net_hdr";
        stdout-path = "serial:115200n8";
    };

    memory@0 {
        device_type = "memory";
        reg = <0x00000000 0x00000000 0x00000000 0x00040000
               0x00000000 0x00040000 0x00000000 0x00040000
               0x00000000 0x00080000 0x00000000 0x006dd000
               0x00000000 0x0075d000 0x00000000 0x2a8a3000
               0x00000000 0x2b000000 0x00000000 0x05000000>;
    };

    cpus {
        #address-cells = <0x1>;
        #size-cells = <0x0>;

        cpu@0 {
            device_type = "cpu";
            compatible = "arm,cortex-a53";
            reg = <0x0>;
            operating-points-v2 = <0x1>;
        };
    };

    cpu-opp-table {
        compatible = "operating-points-v2";
        opp-shared;
        linux,phandle = <0x1>;
        phandle = <0x1>;

        opp00 {
            opp-hz = /bits/ 64 <1199999988>;
            opp-microvolt = <1000000>;
            clock-latency-ns = <500000>;
        };

        opp01 {
            opp-hz = /bits/ 64 <599999994>;
            opp-microvolt = <1000000>;
            clock-latency-ns = <500000>;
        };

        opp02 {
            opp-hz = /bits/ 64 <399999996>;
            opp-microvolt = <1000000>;
            clock-latency-ns = <500000>;
        };

        opp03 {
            opp-hz = /bits/ 64 <299999997>;
            opp-microvolt = <1000000>;
            clock-latency-ns = <500000>;
        };
    };

    clk100: clk100 {
        compatible = "fixed-clock";
        #clock-cells = <0x0>;
        clock-frequency = <99999999>;
        linux,phandle = <0x3>;
        phandle = <0x3>;
    };

    clk125: clk125 {
        compatible = "fixed-clock";
        #clock-cells = <0>;
        clock-frequency = <125000000>;
        linux,phandle = <0x4>;
        phandle = <0x4>;
    };

    clk250: clk250 {
        compatible = "fixed-clock";
        #clock-cells = <0>;
        clock-frequency = <250000000>;
        linux,phandle = <0x5>;
        phandle = <0x5>;
    };

    timer {
        compatible = "arm,armv8-timer";
        interrupts = <GIC_PPI 0xd (GIC_CPU_MASK_SIMPLE(4) | IRQ_TYPE_LEVEL_LOW)>,
            <GIC_PPI 0xe (GIC_CPU_MASK_SIMPLE(4) | IRQ_TYPE_LEVEL_LOW)>,
            <GIC_PPI 0xb (GIC_CPU_MASK_SIMPLE(4) | IRQ_TYPE_LEVEL_LOW)>,
            <GIC_PPI 0xa (GIC_CPU_MASK_SIMPLE(4) | IRQ_TYPE_LEVEL_LOW)>;
        clock-frequency = <100000000>;
    };

    amba-apu@30000000 {
        compatible = "simple-bus";
        #address-cells = <0x2>;
        #size-cells = <0x2>;
        ranges = <0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x30002000>;

        interrupt-controller@30000000 {
            compatible = "muensk,irq-v0";
            #interrupt-cells = <0x3>;
            interrupt-controller;
            reg = <0x00000000 0x30000000 0x00000000 0x00002000>;
            interrupts = <GIC_PPI 0x9 (GIC_CPU_MASK_SIMPLE(4) | IRQ_TYPE_LEVEL_HIGH)>;
            linux,phandle = <0x7>;
            phandle = <0x7>;
        };

    };

    amba-soc@31000000 {
        compatible = "simple-bus";
        #address-cells = <0x2>;
        #size-cells = <0x2>;
        ranges = <0x00000000 0x00000000 0x00000000 0x00000000 0x00000000 0x31054000>;

        serial_0: uart0@31000000 {
            compatible = "cdns,uart-r1p12", "xlnx,xuartps";
            reg = <0x00000000 0x31000000 0x00000000 0x00001000>;
            interrupt-parent = <0x7>;
            interrupts = <GIC_SPI 0x0 IRQ_TYPE_LEVEL_HIGH>;
            clocks = <&clk100>, <&clk100>;
            clock-names = "uart_clk", "pclk";
            status = "okay";
        };

        usb3_0_xhci@31001000 {
            #address-cells = <0x2>;
            #size-cells = <0x2>;
            compatible = "xlnx,zynqmp-dwc3";
            reg = <0x00000000 0x31001000 0x00000000 0x00001000>;
            status = "okay";
            ranges;

            usb3_0_xhci_dwc3@31010000 {
                compatible = "snps,dwc3";
                reg = <0x00000000 0x31010000 0x00000000 0x00040000>;
                interrupt-parent = <0x7>;
                interrupts = <GIC_SPI 0x2 IRQ_TYPE_LEVEL_HIGH>,
                    <GIC_SPI 0x3 IRQ_TYPE_LEVEL_HIGH>,
                    <GIC_SPI 0x4 IRQ_TYPE_LEVEL_HIGH>;
                clocks = <&clk250>, <&clk250>;
                clock-names = "ref", "bus_early";
                snps,quirk-frame-length-adjustment = <0x20>;
                snps,resume-hs-terminations;
                snps,usb2-lpm-disable;
                snps,dis_u3_susphy_quirk;
                snps,dis_u2_susphy_quirk;
                maximum-speed = "super-speed";
                dr_mode = "host";
                status = "okay";
            };
        };

        string_reverser_writer@31050000 {
            compatible = "muen,communication-channel";
            reg = <0x00000000 0x31050000 0x00000000 0x00001000>;
            interrupt-parent = <0x7>;
            interrupts = <GIC_SPI 0x8 IRQ_TYPE_LEVEL_HIGH>;
            type = <WRITEONLY_CHANNEL>;
            status = "okay";
        };

        string_reverser_reader@31051000 {
            compatible = "muen,communication-channel";
            reg = <0x00000000 0x31051000 0x00000000 0x00001000>;
            interrupt-parent = <0x7>;
            interrupts = <GIC_SPI 0x9 IRQ_TYPE_LEVEL_HIGH>;
            type = <READONLY_CHANNEL>;
            status = "okay";
        };

        log_channel_reader@31052000 {
            compatible = "muen,communication-channel";
            reg = <0x00000000 0x31052000 0x00000000 0x00001000>;
            interrupt-parent = <0x7>;
            interrupts = <GIC_SPI 0xa IRQ_TYPE_LEVEL_HIGH>;
            type = <READONLY_CHANNEL>;
            status = "okay";
        };

        lnx_channel_writer@31053000 {
            compatible = "muen,communication-channel";
            reg = <0x00000000 0x31053000 0x00000000 0x00001000>;
            interrupt-parent = <0x7>;
            interrupts = <GIC_SPI 0xb IRQ_TYPE_LEVEL_HIGH>;
            type = <WRITEONLY_CHANNEL>;
            status = "okay";
        };

    };

};
